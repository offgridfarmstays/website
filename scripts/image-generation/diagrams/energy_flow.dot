// Energy Flow Diagram for Offgrid Farmstays
// Generate with: dot -Tpng energy_flow.dot -o ../../assets/diagrams/energy_flow.png

digraph EnergyFlow {
    // Graph settings
    rankdir=TB;
    bgcolor="transparent";
    fontname="Arial";
    compound=true;
    nodesep=0.8;
    ranksep=1.2;

    // Node styles
    node [fontname="Arial", fontsize=11, style=filled];

    // Energy source nodes
    solar [label="SOLAR", shape=ellipse, fillcolor="#FFD700", fontcolor=black, penwidth=3, color="#FF8C00", fontsize=13];
    hydro [label="HYDRO", shape=ellipse, fillcolor="#4682B4", fontcolor=white, penwidth=3, color="#1E90FF", fontsize=13];
    geo [label="GEOTHERMAL", shape=ellipse, fillcolor="#228B22", fontcolor=white, penwidth=3, color="#32CD32", fontsize=13];

    // Distribution nodes with titles inside
    retreat [label="RETREAT\n━━━━━\nLights, Appliances\nHVAC, Water Heating", shape=box, fillcolor="#E8F4F8", color="#4682B4", penwidth=2, fontsize=10];
    mining [label="BITCOIN MINING\n━━━━━\nASIC Miners\nImmersion Cooled", shape=box, fillcolor="#FFF9E6", color="#F7931A", penwidth=2, fontsize=10];
    battery [label="STORAGE\n━━━━━\nNighttime Use\nBackup Power", shape=box, fillcolor="#E8F8E8", color="#228B22", penwidth=2, fontsize=10];

    // Heat reuse node
    heat [label="HEAT REUSE\n━━━━━\nWaste Heat Capture\nFrom Mining", shape=box, fillcolor="#FFE4B5", color="#FF4500", penwidth=2, fontsize=10];

    // Revenue
    revenue [label="GUEST BOOKINGS\n+\nBITCOIN EARNINGS", shape=box, style="filled,rounded", fillcolor="#90EE90", color="#228B22", penwidth=3, fontsize=11];

    // Rank groupings
    {rank=same; solar; hydro; geo;}
    {rank=same; retreat; mining; battery;}
    {rank=same; heat; revenue;}

    // Energy source connections to distribution
    solar -> retreat [penwidth=2, color="#FFD700"];
    solar -> mining [penwidth=2, color="#FFD700"];
    solar -> battery [penwidth=2, color="#FFD700"];

    hydro -> retreat [penwidth=2, color="#4682B4"];
    hydro -> mining [penwidth=2, color="#4682B4"];
    hydro -> battery [penwidth=2, color="#4682B4"];

    geo -> retreat [penwidth=2, color="#228B22"];
    geo -> mining [penwidth=2, color="#228B22"];

    // Heat connections
    mining -> heat [penwidth=3, color="#FF4500"];

    // Revenue connections
    retreat -> revenue [style=dashed, penwidth=1.5];
    mining -> revenue [style=dashed, penwidth=1.5];

    // Title
    labelloc="t";
    label=<<b>Integrated Energy System Flow</b><br/>Solar + Hydro + Geothermal → Retreat + Bitcoin + Heat Reuse>;
    fontsize=16;
}
